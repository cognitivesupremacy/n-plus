<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="ScreenOrientation" content="autoRotate:disabled" />
    <title>N+</title>
    <link rel="icon" type="image/png" href="assets/ico.png" />
    <link
      rel="preload"
      href="assets/suisse/SuisseIntl-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <link
      rel="preload"
      href="assets/suisse/SuisseIntl-Medium.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <style>
      @font-face {
        font-family: "Suisse";
        src: url("assets/suisse/SuisseIntl-Regular.woff2") format("woff2");
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
      @font-face {
        font-family: "Suisse";
        src: url("assets/suisse/SuisseIntl-Medium.woff2") format("woff2");
        font-weight: 500;
        font-style: normal;
        font-display: swap;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body,
      html {
        height: 100%;
        width: 100%;
        font-family: "Suisse", sans-serif;
        font-weight: 400;
        background: url("assets/back.jpg") no-repeat center center fixed;
        background-position: calc(50%) calc(60%);
        background-size: cover;
        background-color: black;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: rgba(255, 255, 255, 0.8);
        text-align: center;
        font-size: 12px;
        line-height: 1.2;
        overflow: hidden;
      }

      ::selection {
        background: white; /* Sfondo bianco */
        color: rgba(0, 0, 0, 0.5); /* Testo nero con 50% di trasparenza */
      }

      .cs-type {
        top: 27px;
        left: 30px;
        display: none;
      }

      .cs-type,
      .bottom {
        width: calc(100vw - 60px);
        left: 30px;
      }

      /* .n-type {
        margin-bottom: 7px;
        width: 100%;
      } */

      .n-type {
        top: 30px;
        /* width: calc(100vw - 60px); */
        width: 200px;
        position: absolute;
      }

      .bottom-paragraph {
      }

      .bottom {
        bottom: 30px;
        position: absolute;

        /* align-items: center; */
      }
      a {
        display: block;
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        text-transform: uppercase;
        cursor: pointer !important;
      }
      .email {
        display: block;
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        text-transform: uppercase;
        line-height: 1.5;
      }

      @media (max-width: 600px) {
        body {
          font-size: 11px;
        }
        .cs-type {
        }

        .n-type {
          width: 150px;
        }

        .desktop {
          display: none;
        }

        /* .cs-type {
          top: 30px;
        }

        .bottom {
          bottom: 10px;
        } */

        .cs-type,
        .bottom {
          width: calc(100vw - 30px);
          left: 15px;
          position: absolute;
        }
      }

      .content {
        overflow: scroll;
      }

      #sonar-list {
        display: flex;
        flex-direction: column;
        position: relative;

        background-color: black;
        padding: 10px;
        padding-top: 0;
        width: 90vw;
        max-width: 800px;
        text-align: left;
        max-height: 400px;

        font-variant-numeric: tabular-nums;
        font-feature-settings: "tnum";

        display: none;
      }

      .sonar-row {
        display: flex;
        width: 100%;
        gap: 0;
      }

      .sonar-row span {
        flex: 1 1 0;
        text-align: left;
        padding: 0;
        min-width: 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .close-bar {
        position: absolute;
        top:0;
        transform: translateY(-100%);
        width: 100%;
        background-color: white;
        left: 0;
        color: black;
        padding: 5px 10px;
        line-height: 1;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      @keyframes flash-bg {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
    </style>
  </head>

  <body>

    <div id="sonar-list">
      <div class="close-bar">
        <span>NPLUS</span>
        <span id="closeIcon" style="cursor: pointer">âœ•</span>
      </div>
      <div class="header sonar-row" style="position: sticky;top: 0;background-color: black;padding-top: 10px;">
        <span>SONAR+D</span>
        <span>TIME</span>
        <span>SESSION</span>
        <span>NEURAL PROCESSING STREAM</span>
      </div>
      <div class="content"></div>
    </div>
    
    <img src="assets/cs.png" class="cs-type" />
    <img src="assets/n+full.png" class="n-type" />
    <div class="bottom">
      <p id="openIcon" style="cursor: pointer; animation: flash-bg 1s steps(1, end) infinite;">MINING SESSION AT SONAR FESTIVAL</p>
      <br>
      <p class="bottom-paragraph">
        N+ Industries redefines warfare by weaponizing neuroscience,
        <br class="desktop" />engineering the cognitive infrastructure that will
        shape tomorrow's global equilibrium.
        <a href="mailto:info@n-plus.industries" class="email">EMAIL</a>
        <a href="https://www.instagram.com/cognitive_supremacy/">INSTAGRAM</a>
      </p>
    </div>
  </body>

  <script>
    // function updateImages() {
    //   const nImages = document.querySelectorAll(".n-type");
    //   const csImages = document.querySelectorAll(".cs-type");

    //   nImages.forEach((img) => {
    //     if (window.innerWidth <= 800) {
    //       img.src = "assets/n+-m.png";
    //     } else {
    //       img.src = "assets/n+.png";
    //     }
    //   });

    //   csImages.forEach((img) => {
    //     if (window.innerWidth <= 800) {
    //       img.src = "assets/cs-m.png";
    //     } else {
    //       img.src = "assets/cs.png";
    //     }
    //   });
    // }

    // let currentBackground = 1; // parte da 1
    // const totalBackgrounds = 7; // quante immagini hai

    // document.body.addEventListener("click", () => {
    //   currentBackground++;
    //   if (currentBackground > totalBackgrounds) {
    //     currentBackground = 1;
    //   }
    //   document.body.style.backgroundImage = `url('assets/back${currentBackground}.png')`;
    // });

    // window.addEventListener("resize", updateImages);
    // window.addEventListener("load", updateImages);
  </script>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>

    document.getElementById("openIcon").onclick = function() {
      const sonarList = document.getElementById("sonar-list");
      sonarList.style.display = "flex";
      sonarList.style.left = "unset";
      sonarList.style.top = "unset";
      sonarList.style.position = sonarList.style.position || "absolute";
      sonarList.style.zIndex = 1000;
    };

    document.getElementById("closeIcon").onclick = function() {
      document.getElementById("sonar-list").style.display = "none";
    };

    // Configura Supabase
    const supabaseUrl = "https://vvxdugranihmsbmrfdpf.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2eGR1Z3JhbmlobXNibXJmZHBmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkzOTI5ODQsImV4cCI6MjA2NDk2ODk4NH0.a8DNkCkBW5QB8Jt4TozzB46lI0LymOsQAmSysuhrPMI";
    
    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
    console.log(supabase);
    
    // Funzione per leggere i dati
    async function getSonarData() {
      console.log('loaded');
      
        const { data, error } = await supabase
          .from('sonar')
          .select()
          .order('session', { ascending: false })

        console.log('DATA:', data);
        console.log('ERROR:', error);

      
      // Mostra i dati in una lista
      const list = document.querySelector('#sonar-list .content');
      list.innerHTML = '';

      data.forEach(row => {
        const div = document.createElement('div');
        div.className = 'sonar-row';
        div.style.display = 'flex';

        const neural = document.createElement('span');
        // Aggiungi "%" se non presente
        let neuralValue = row.neural_stram || "";
        if (neuralValue && !neuralValue.includes("%")) {
          neuralValue += "%";
        }
        neural.textContent = '+ ' + neuralValue;

        const session = document.createElement('span');
        session.textContent = row.session.toString().padStart(4, '0');

        const time = document.createElement('span');
        time.textContent = `${row.time}`;

        const date = document.createElement('span');
        date.textContent = `${row.created_at.split('T')[0]}`;
        
        if (row.created_at.split('T')[0] != "2025-06-11" && row.created_at.split('T')[0] != "2025-06-09" && row.created_at.split('T')[0] != "2025-06-08") {
          
          div.appendChild(date);
          div.appendChild(time);
          div.appendChild(session);
          div.appendChild(neural);
        } else {
        }

        list.appendChild(div);
      });
      
    }

    // Chiama la funzione al caricamento della pagina
    window.addEventListener('DOMContentLoaded', getSonarData);
    
    (function() {
  const dragBar = document.querySelector('.close-bar');
  const sonarList = document.getElementById('sonar-list');
  let isDragging = false;
  let offset = { x: 0, y: 0 };

  dragBar.style.cursor = 'grab';

  dragBar.addEventListener('mousedown', function(e) {
    isDragging = true;
    dragBar.style.cursor = 'grabbing';
    const rect = sonarList.getBoundingClientRect();
    offset.x = e.clientX - rect.left;
    offset.y = e.clientY - rect.top;
    sonarList.style.position = 'absolute';
    sonarList.style.zIndex = 1000;
    document.body.style.userSelect = 'none';
  });

  document.addEventListener('mousemove', function(e) {
    if (!isDragging) return;
    sonarList.style.left = (e.clientX - offset.x) + 'px';
    sonarList.style.top = (e.clientY - offset.y) + 'px';
  });

  document.addEventListener('mouseup', function() {
    if (isDragging) {
      isDragging = false;
      dragBar.style.cursor = 'grab';
      document.body.style.userSelect = '';
    }
  });
})();
  </script>
</html>
